<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Japanese Kana Practice</title>
<link rel="manifest" href="manifest.json">

<style>
body {
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 10px;
    max-width: 480px;
    margin: auto;
}
#tabs {
    margin-bottom: 15px;
    display: flex;
    justify-content: space-between;
}
.tab {
    flex: 1;
    padding: 10px;
    margin: 3px;
    border: 2px solid #0066ff;
    border-radius: 8px;
    cursor: pointer;
    font-size: 14px;
}
.tab.active {
    background-color: #0066ff;
    color: white;
}
#question {
    font-size: 40px;
    margin: 15px;
}
#answer {
    font-size: 40px;
    margin: 15px;
    color: green;
    display: none;
}
button {
    padding: 14px;
    font-size: 18px;
    margin: 8px auto;
    width: 95%;
    display: block;
}
canvas {
    border: 2px solid #000;
    margin: 15px auto;
    width: 100%;
    height: 300px;
    touch-action: none;
}
</style>
</head>
<body>

<h2>Japanese Kana Practice</h2>

<div id="tabs">
    <div class="tab active" onclick="setMode('hiragana')">Hiragana</div>
    <div class="tab" onclick="setMode('katakana')">Katakana</div>
    <div class="tab" onclick="setMode('both')">Both</div>
</div>

<div id="question">Press NEXT to start</div>
<div id="answer"></div>

<button onclick="showAnswer()">Show Answer</button>
<button onclick="nextQuestion()">Next</button>
<button onclick="clearCanvas()">Clear Drawing</button>

<h3>Draw your answer:</h3>
<canvas id="draw-area" width="300" height="300"></canvas>

<script>
const hiraganaList = [
    ["a","あ"],["i","い"],["u","う"],["e","え"],["o","お"],
    ["ka","か"],["ki","き"],["ku","く"],["ke","け"],["ko","こ"],
    ["sa","さ"],["shi","し"],["su","す"],["se","せ"],["so","そ"],
    ["ta","た"],["chi","ち"],["tsu","つ"],["te","て"],["to","と"],
    ["na","な"],["ni","に"],["nu","ぬ"],["ne","ね"],["no","の"],
    ["ha","は"],["hi","ひ"],["fu","ふ"],["he","へ"],["ho","ほ"],
    ["ma","ま"],["mi","み"],["mu","む"],["me","め"],["mo","も"],
    ["ya","や"],["yu","ゆ"],["yo","よ"],
    ["ra","ら"],["ri","り"],["ru","る"],["re","れ"],["ro","ろ"],
    ["wa","わ"],["wo","を"],["n","ん"]
];

const katakanaList = [
    ["a","ア"],["i","イ"],["u","ウ"],["e","エ"],["o","オ"],
    ["ka","カ"],["ki","キ"],["ku","ク"],["ke","ケ"],["ko","コ"],
    ["sa","サ"],["shi","シ"],["su","ス"],["se","セ"],["so","ソ"],
    ["ta","タ"],["chi","チ"],["tsu","ツ"],["te","テ"],["to","ト"],
    ["na","ナ"],["ni","ニ"],["nu","ヌ"],["ne","ネ"],["no","ノ"],
    ["ha","ハ"],["hi","ヒ"],["fu","フ"],["he","ヘ"],["ho","ホ"],
    ["ma","マ"],["mi","ミ"],["mu","ム"],["me","メ"],["mo","モ"],
    ["ya","ヤ"],["yu","ユ"],["yo","ヨ"],
    ["ra","ラ"],["ri","リ"],["ru","ル"],["re","レ"],["ro","ロ"],
    ["wa","ワ"],["wo","ヲ"],["n","ン"]
];

let currentMode = 'hiragana';
let currentPool = hiraganaList.slice();
let current = null;

function setMode(mode) {
    currentMode = mode;
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));

    if(mode === 'hiragana') document.querySelectorAll('.tab')[0].classList.add('active');
    if(mode === 'katakana') document.querySelectorAll('.tab')[1].classList.add('active');
    if(mode === 'both') document.querySelectorAll('.tab')[2].classList.add('active');

    currentPool =
        mode === 'hiragana' ? hiraganaList.slice() :
        mode === 'katakana' ? katakanaList.slice() :
        hiraganaList.concat(katakanaList);

    nextQuestion();
}

function nextQuestion() {
    current = currentPool[Math.floor(Math.random()*currentPool.length)];
    document.getElementById("question").innerText = current[0];
    document.getElementById("answer").style.display = "none";
    clearCanvas();
}

function showAnswer() {
    let ans = "";

    if (currentMode === 'both') {
        let h = hiraganaList.find(x => x[0] === current[0]);
        let k = katakanaList.find(x => x[0] === current[0]);
        ans = `${h ? h[1] : ""} / ${k ? k[1] : ""}`;
    } else {
        ans = current[1];
    }

    document.getElementById("answer").innerText = ans;
    document.getElementById("answer").style.display = "block";
}

// Drawing canvas
const canvas = document.getElementById("draw-area");
const ctx = canvas.getContext("2d");
let drawing = false;

function pos(e) {
    const rect = canvas.getBoundingClientRect();
    return [
        (e.touches ? e.touches[0].clientX : e.clientX) - rect.left,
        (e.touches ? e.touches[0].clientY : e.clientY) - rect.top
    ];
}

canvas.addEventListener("mousedown", e => {
    drawing = true;
    ctx.beginPath();
    let [x,y] = pos(e);
    ctx.moveTo(x,y);
});
canvas.addEventListener("mousemove", e => {
    if(drawing) {
        let [x,y] = pos(e);
        ctx.lineWidth = 6;
        ctx.lineCap = "round";
        ctx.lineTo(x,y);
        ctx.stroke();
    }
});
canvas.addEventListener("mouseup", ()=> drawing=false);
canvas.addEventListener("mouseout", ()=> drawing=false);

canvas.addEventListener("touchstart", e => {
    e.preventDefault();
    drawing = true;
    ctx.beginPath();
    let [x,y] = pos(e);
    ctx.moveTo(x,y);
});
canvas.addEventListener("touchmove", e => {
    e.preventDefault();
    if(drawing){
        let [x,y] = pos(e);
        ctx.lineWidth = 6;
        ctx.lineTo(x,y);
        ctx.stroke();
    }
});
canvas.addEventListener("touchend", ()=> drawing=false);

function clearCanvas() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
}

if("serviceWorker" in navigator){
    navigator.serviceWorker.register("sw.js");
}
</script>

</body>
</html>
